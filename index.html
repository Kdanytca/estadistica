<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lisis Estad√≠stico Avanzado</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }

        /* Contenedor Principal */
        .statistics-container {
            max-width: 950px;
            margin: 0 auto;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #333;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 25px;
        }

        /* Secci√≥n de Input */
        .input-section {
            padding: 20px;
            border: 1px solid #c9c9c9;
            border-radius: 8px;
            margin-bottom: 30px;
            background-color: #eaf6ff;
        }

        #dataInput {
            width: 100%;
            padding: 12px;
            margin-top: 8px;
            margin-bottom: 15px;
            border: 1px solid #aaa;
            border-radius: 5px;
            box-sizing: border-box;
            resize: vertical;
            font-size: 16px;
        }

        .input-section button {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .input-section button:hover {
            background-color: #2980b9;
        }

        #dataStatus {
            margin-top: 10px;
            font-weight: bold;
        }

        /* Estilos de Pesta√±as */
        .tab-controls-stats {
            display: flex;
            border-bottom: 3px solid #ccc;
            margin-bottom: 20px;
        }

        .tab-btn-stats {
            padding: 12px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-right: 5px;
            color: #555;
        }

        .tab-btn-stats.active {
            font-weight: bold;
            color: #3498db;
            border-bottom: 3px solid #3498db;
        }

        /* Contenido de Pesta√±as */
        .tab-pane-stats {
            display: none;
            padding: 15px 0;
            animation: fadeIn 0.5s;
        }

        .tab-pane-stats.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Estilo de Cuadr√≠cula para Resultados */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .results-grid>div {
            background-color: #f0f3f6;
            padding: 18px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }

        .results-grid>div:hover {
            transform: translateY(-2px);
        }

        .results-grid strong {
            display: block;
            font-size: 1.1em;
            color: #2c3e50;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .formula {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #e74c3c;
            display: block;
            margin-top: 5px;
        }

        /* Estilo de Cuadr√≠cula para Posici√≥n */
        .results-position {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .results-position h3 {
            grid-column: 1 / -1;
            margin-top: 10px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            color: #34495e;
        }

        .results-position>div {
            background-color: #f0f3f6;
            padding: 18px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }

        .results-position strong {
            display: block;
            font-size: 1.1em;
            color: #2c3e50;
            margin-bottom: 5px;
            font-weight: 600;
        }
    </style>
</head>

<body>

    <div class="statistics-container">
        <h2>An√°lisis Estad√≠stico de Datos üìä</h2>

        <div class="input-section">
            <label for="dataInput">Ingresa los datos separados por comas:</label>
            <textarea id="dataInput" rows="4" placeholder="Ejemplo: 2, 4, 4, 4, 5, 5, 7, 9, 10"></textarea>
            <button onclick="procesarDatos()">Procesar y Calcular</button>
            <p id="dataStatus" style="color: #333;"></p>
        </div>

        <div class="tab-controls-stats">
            <button class="tab-btn-stats active" data-tab="resumen">Resumen y Centralidad</button>
            <button class="tab-btn-stats" data-tab="dispersion">Dispersi√≥n</button>
            <button class="tab-btn-stats" data-tab="posicion">Posici√≥n (Cuartiles, Deciles)</button>
        </div>

        <div class="tab-content-stats">
            <div id="resumen" class="tab-pane-stats active">
                <h3>Medidas de Tendencia Central</h3>
                <div id="resumenResults" class="results-grid">
                    <p>Ingresa datos para ver el resumen.</p>
                </div>
            </div>

            <div id="dispersion" class="tab-pane-stats">
                <h3>Medidas de Dispersi√≥n</h3>
                <div id="dispersionResults" class="results-grid">
                    <p>Ingresa datos para ver la dispersi√≥n.</p>
                </div>
            </div>

            <div id="posicion" class="tab-pane-stats">
                <h3>Medidas de Posici√≥n (Cuartiles y Deciles)</h3>
                <div id="posicionResults" class="results-position">
                    <p>Ingresa datos para ver las medidas de posici√≥n.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let datos = [];

        // =======================================================
        // üßÆ FUNCIONES DE C√ÅLCULO ESTAD√çSTICO
        // =======================================================

        function calcularMedia(arr) {
            if (arr.length === 0) return 0;
            const suma = arr.reduce((acc, val) => acc + val, 0);
            return suma / arr.length;
        }

        function calcularMediana(arr) {
            const n = arr.length;
            if (n === 0) return 0;

            if (n % 2 !== 0) {
                return arr[Math.floor(n / 2)];
            }
            else {
                const mid1 = arr[n / 2 - 1];
                const mid2 = arr[n / 2];
                return (mid1 + mid2) / 2;
            }
        }

        function calcularModa(arr) {
            if (arr.length === 0) return 'N/A';

            const frecuencia = {};
            let maxFrecuencia = 0;
            let modas = [];

            for (const num of arr) {
                frecuencia[num] = (frecuencia[num] || 0) + 1;
                if (frecuencia[num] > maxFrecuencia) {
                    maxFrecuencia = frecuencia[num];
                }
            }

            for (const num in frecuencia) {
                if (frecuencia[num] === maxFrecuencia) {
                    modas.push(parseFloat(num));
                }
            }

            if (maxFrecuencia === 1) {
                return 'No hay moda clara (todos los valores son √∫nicos)';
            }
            if (modas.length === arr.length) {
                return 'Multimodal (todos ocurren con la misma frecuencia)';
            }

            return modas.map(m => m.toFixed(3)).join(', ');
        }

        function calcularRango(arr) {
            if (arr.length === 0) return 0;
            return arr[arr.length - 1] - arr[0];
        }

        function calcularVarianzaPoblacional(arr, media) {
            if (arr.length === 0) return 0;

            const sumatoriaDiferenciasCuadrado = arr.reduce((acc, val) => {
                const diferencia = val - media;
                return acc + diferencia * diferencia;
            }, 0);

            return sumatoriaDiferenciasCuadrado / arr.length;
        }

        function calcularVarianzaMuestral(arr, media) {
            if (arr.length <= 1) return NaN;

            const sumatoriaDiferenciasCuadrado = arr.reduce((acc, val) => {
                const diferencia = val - media;
                return acc + diferencia * diferencia;
            }, 0);

            return sumatoriaDiferenciasCuadrado / (arr.length - 1);
        }

        /**
          * Calcula medidas de posici√≥n (Percentiles P) usando interpolaci√≥n lineal (Tipo 7).
          * La f√≥rmula es: P = X_i + (k - i) * (X_{i+1} - X_i)
          * donde k = P * (n - 1) / 100
          * @param {number[]} arr - El conjunto de datos ordenado.
          * @param {number} p - El percentil deseado (de 0 a 100).
          * @returns {number} El valor del percentil.
          */
        function calcularPosicion(arr, p) {
            if (arr.length === 0) return 0;
            if (p <= 0) return arr[0];
            if (p >= 100) return arr[arr.length - 1];

            const n = arr.length;
            // Posici√≥n K = p * (n - 1) / 100
            const k = (p / 100) * (n - 1);

            const i = Math.floor(k); // √çndice inferior
            const f = k - i;         // Parte fraccionaria (k - i)

            if (i >= n - 1) return arr[n - 1];

            // Interpolaci√≥n: Valor = arr[i] + f * (arr[i+1] - arr[i])
            return arr[i] + f * (arr[i + 1] - arr[i]);
        }

        // Funci√≥n auxiliar para generar la f√≥rmula de posici√≥n para un Percentil P
        function getFormulaPosicion(p) {
            // El cuartil Q1 es el percentil P25. El decil D1 es el P10.
            return `P = ${p} (donde k = ${p}*(n-1)/100)`;
        }


        // =======================================================
        // üíª FUNCIONES DE INTERFAZ Y PROCESAMIENTO
        // =======================================================

        function limpiarResultados() {
            document.getElementById('resumenResults').innerHTML = '<p>Ingresa datos para ver el resumen.</p>';
            document.getElementById('dispersionResults').innerHTML = '<p>Ingresa datos para ver la dispersi√≥n.</p>';
            document.getElementById('posicionResults').innerHTML = '<p>Ingresa datos para ver las medidas de posici√≥n.</p>';
        }

        function calcularYMostrarResultados() {
            if (datos.length === 0) {
                limpiarResultados();
                return;
            }

            // 1. C√ÅLCULOS PRINCIPALES
            const media = calcularMedia(datos);
            const mediana = calcularMediana(datos);
            const moda = calcularModa(datos);
            const rango = calcularRango(datos);
            const varianzaP = calcularVarianzaPoblacional(datos, media);
            const desvTipicaP = Math.sqrt(varianzaP);
            const varianzaM = calcularVarianzaMuestral(datos, media);
            const desvTipicaM = Math.sqrt(varianzaM);
            const coeficienteVariacion = media === 0 ? 'N/A' : (desvTipicaM / media * 100);

            // 2. C√ÅLCULOS DE POSICI√ìN
            const q1 = calcularPosicion(datos, 25);
            const q2 = calcularPosicion(datos, 50);
            const q3 = calcularPosicion(datos, 75);
            const iqr = q3 - q1;

            // Deciles D1 a D9
            const deciles = Array.from({ length: 9 }, (_, i) => ({
                label: `D${i + 1} (P${(i + 1) * 10})`,
                value: calcularPosicion(datos, (i + 1) * 10),
                percentil: (i + 1) * 10
            }));

            const n = datos.length;
            const min = datos[0];
            const max = datos[n - 1];

            // --- PESTA√ëA 1: RESUMEN GENERAL ---
            const resumenHTML = `
                <div>
                    <strong>Total de Datos (n)</strong>${n}
                    <span class="formula">n = Cantidad de valores</span>
                </div>
                <div>
                    <strong>M√≠nimo (Min)</strong>${min.toFixed(3)}
                    <span class="formula">Min = Dato menor en el conjunto</span>
                </div>
                <div>
                    <strong>M√°ximo (Max)</strong>${max.toFixed(3)}
                    <span class="formula">Max = Dato mayor en el conjunto</span>
                </div>
                <div>
                    <strong>Rango (R)</strong>${rango.toFixed(3)}
                    <span class="formula">R = Max - Min</span>
                </div>
                <div>
                    <strong>Media (Œº o xÃÑ)</strong>${media.toFixed(3)}
                    <span class="formula">Œº = (Œ£x) / n</span>
                </div>
                <div>
                    <strong>Mediana (Me)</strong>${mediana.toFixed(3)}
                    <span class="formula">Me = Valor central (o promedio de los 2 centrales)</span>
                </div>
                <div>
                    <strong>Moda (Mo)</strong>${moda}
                    <span class="formula">Mo = Dato con mayor frecuencia</span>
                </div>
            `;
            document.getElementById('resumenResults').innerHTML = resumenHTML;


            // --- PESTA√ëA 2: DISPERSI√ìN ---
            const dispersionHTML = `
                <div>
                    <strong>Varianza Poblacional (œÉ¬≤)</strong>${varianzaP.toFixed(3)}
                    <span class="formula">œÉ¬≤ = Œ£(x - Œº)¬≤ / n</span>
                </div>
                <div>
                    <strong>Desviaci√≥n T√≠pica Poblacional (œÉ)</strong>${desvTipicaP.toFixed(3)}
                    <span class="formula">œÉ = &radic;(œÉ¬≤)</span>
                </div>
                <div>
                    <strong>Varianza Muestral (s¬≤)</strong>
                        ${n <= 1 ? 'N/A' : varianzaM.toFixed(3)}
                    <span class="formula">s¬≤ = Œ£(x - xÃÑ)¬≤ / (n - 1)</span>
                </div>
                <div>
                    <strong>Desviaci√≥n T√≠pica Muestral (s)</strong>
                        ${n <= 1 ? 'N/A' : desvTipicaM.toFixed(3)}
                    <span class="formula">s = &radic;(s¬≤)</span>
                </div>
                <div>
                    <strong>Coeficiente de Variaci√≥n (%)</strong>
                        ${coeficienteVariacion === 'N/A' ? 'N/A' : coeficienteVariacion.toFixed(2) + ' %'}
                    <span class="formula">CV = (s / xÃÑ) * 100</span>
                </div>
                <div>
                    <strong>Rango Intercuart√≠lico (IQR)</strong>
                        ${iqr.toFixed(3)}
                    <span class="formula">IQR = Q3 - Q1</span>
                </div>
            `;
            document.getElementById('dispersionResults').innerHTML = dispersionHTML;


            // --- PESTA√ëA 3: POSICI√ìN ---
            let posicionHTML = `
                <div style="grid-column: 1 / -1; margin-bottom: 5px;">
                    <h3>Cuartiles (P: 25, 50, 75)</h3>
                    <p style="font-size: 0.9em; color: #7f8c8d;">
                        F√≥rmula Base para Cuartiles y Deciles (Percentil P): 
                        <span class="formula" style="color: #3498db; display: inline;">P = Dato_i + Fracci√≥n * (Dato_{i+1} - Dato_i)</span> 
                        <span style="font-size: 0.8em; color: #95a5a6;">(Se usa el m√©todo de interpolaci√≥n lineal, donde P se convierte a un √≠ndice)</span>
                    </p>
                </div>
                <div>
                    <strong>Q1 (P25)</strong>${q1.toFixed(3)}
                    <span class="formula">${getFormulaPosicion(25)}</span>
                </div>
                <div>
                    <strong>Q2 (Mediana/P50)</strong>${q2.toFixed(3)}
                    <span class="formula">${getFormulaPosicion(50)}</span>
                </div> 
                <div>
                    <strong>Q3 (P75)</strong>${q3.toFixed(3)}
                    <span class="formula">${getFormulaPosicion(75)}</span>
                </div>

                <div style="grid-column: 1 / -1;"><h3>Deciles (D1 a D9)</h3></div>
                ${deciles.map(d => `
                    <div>
                        <strong>${d.label}</strong>${d.value.toFixed(3)}
                        <span class="formula">${getFormulaPosicion(d.percentil)}</span>
                    </div>
                `).join('')}
            `;
            document.getElementById('posicionResults').innerHTML = posicionHTML;
        }

        function procesarDatos() {
            const dataInput = document.getElementById('dataInput').value;
            const dataStatus = document.getElementById('dataStatus');

            // Limpiar y validar datos
            const valores = dataInput.split(',')
                .map(s => s.trim())
                .filter(s => s !== '')
                .map(s => parseFloat(s))
                .filter(n => !isNaN(n));

            if (valores.length === 0) {
                dataStatus.textContent = "‚ùå Error: Por favor, ingrese al menos un n√∫mero v√°lido.";
                datos = [];
                limpiarResultados();
                return;
            }

            if (valores.some(n => isNaN(n))) {
                dataStatus.textContent = "‚ö†Ô∏è Advertencia: Se omitieron algunos valores no num√©ricos.";
            } else {
                dataStatus.textContent = `Datos procesados: ${valores.length} valores.`;
            }

            // Almacenar datos y ordenarlos (ESENCIAL)
            datos = valores.sort((a, b) => a - b);

            // Llamar a la funci√≥n principal de c√°lculo y presentaci√≥n
            calcularYMostrarResultados();
        }

        // 4. Control de Pesta√±as (Se mantiene)
        document.addEventListener('DOMContentLoaded', () => {
            const tabControls = document.querySelector('.tab-controls-stats');
            if (tabControls) {
                tabControls.addEventListener('click', (e) => {
                    if (e.target.classList.contains('tab-btn-stats')) {
                        const targetTab = e.target.dataset.tab;

                        // Desactivar todos los botones y paneles
                        document.querySelectorAll('.tab-btn-stats').forEach(btn => btn.classList.remove('active'));
                        document.querySelectorAll('.tab-pane-stats').forEach(pane => pane.classList.remove('active'));

                        // Activar el bot√≥n y el panel objetivo
                        e.target.classList.add('active');
                        document.getElementById(targetTab).classList.add('active');

                        // Si ya hay datos, recalcular y mostrar para asegurar que el contenido se actualice al cambiar de pesta√±a
                        if (datos.length > 0) {
                            calcularYMostrarResultados();
                        }
                    }
                });
            }

            // Asegurar que la primera pesta√±a est√© activa al inicio
            document.getElementById('resumen').classList.add('active');
        });
    </script>

</body>

</html>